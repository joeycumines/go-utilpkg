{
  "analysisDate": "2026-01-26",
  "targetCoverage": "90%",
  "currentCoverage": {
    "main": "77.5%",
    "internal/alternatetwo": "72.7%",
    "internal/alternateone": "69.3%",
    "internal/alternatethree": "57.7%",
    "total": "71.6%"
  },
  "priorityAreas": [
    {
      "id": "COVERAGE_GAP_1",
      "name": "Promise Combinators",
      "location": "promise.go:793-1076",
      "functions": ["All", "Race", "AllSettled", "Any"],
      "currentCoverage": "0.0%",
      "estimatedGain": "+5-8%",
      "category": "CRITICAL",
      "effort": "2-3 hours",
      "testFile": "promise_combinators_test.go",
      "status": "not-started",
      "rationale": "Core Promise/A+ functionality - JavaScript standard compliance"
    },
    {
      "id": "COVERAGE_GAP_2",
      "name": "JS Promise Integration",
      "location": "promise.go:411, 502",
      "functions": ["ThenWithJS", "thenStandalone"],
      "currentCoverage": "0.0%",
      "estimatedGain": "+3-5%",
      "category": "CRITICAL",
      "effort": "1-2 hours",
      "testFile": "promise_js_integration_test.go",
      "status": "not-started",
      "rationale": "JavaScript callback integration in goja-eventloop"
    },
    {
      "id": "COVERAGE_GAP_3",
      "name": "Error Path in Poll",
      "location": "loop.go:987",
      "functions": ["handlePollError"],
      "currentCoverage": "0.0%",
      "estimatedGain": "+2%",
      "category": "CRITICAL",
      "effort": "1 hour",
      "testFile": "poll_error_test.go",
      "status": "not-started",
      "rationale": "Catastrophic error handling - system stability"
    },
    {
      "id": "COVERAGE_GAP_4",
      "name": "State Machine Queries",
      "location": "state.go:91,101,112",
      "functions": ["TransitionAny", "IsTerminal", "CanAcceptWork"],
      "currentCoverage": "0.0%",
      "estimatedGain": "+3-4%",
      "category": "HIGH",
      "effort": "1-2 hours",
      "testFile": "state_machine_test.go",
      "status": "not-started",
      "rationale": "State machine validation - correctness of state transitions"
    },
    {
      "id": "COVERAGE_GAP_5",
      "name": "FD Registration",
      "location": "loop.go:1290-1345",
      "functions": ["RegisterFD", "UnregisterFD", "ModifyFD"],
      "currentCoverage": "0.0%",
      "estimatedGain": "+3-5%",
      "category": "HIGH",
      "effort": "2-3 hours",
      "testFile": "fd_registration_test.go",
      "status": "not-started",
      "rationale": "I/O multiplexing - network/async I/O testing"
    },
    {
      "id": "COVERAGE_GAP_6",
      "name": "alternatethree Promise Core",
      "location": "internal/alternatethree/promise.go",
      "functions": ["Resolve", "Reject", "fanOut", "NewPromise"],
      "currentCoverage": "0.0%",
      "estimatedGain": "+15-20%",
      "category": "CRITICAL",
      "effort": "4-6 hours",
      "testFile": "promise_alternatethree_test.go",
      "status": "not-started",
      "rationale": "Alternative promise implementation - core logic untested"
    },
    {
      "id": "COVERAGE_GAP_7",
      "name": "Registry Scavenge",
      "location": "internal/alternatethree/registry.go:61-237",
      "functions": ["Scavenge", "compactAndRenew"],
      "currentCoverage": "13.8%, 0.0%",
      "estimatedGain": "+5%",
      "category": "HIGH",
      "effort": "2-3 hours",
      "testFile": "registry_scavenge_test.go",
      "status": "not-started",
      "rationale": "Memory leak prevention - weak pointer GC"
    }
  ],
  "mediumPriorityAreas": [
    {
      "id": "COVERAGE_GAP_8",
      "name": "Platform-Specific Wake FD",
      "location": "wakeup_darwin.go:52,58,68",
      "functions": ["drainWakeUpPipe", "isWakeFdSupported", "submitGenericWakeup"],
      "currentCoverage": "0.0%",
      "estimatedGain": "+2-3%",
      "category": "MEDIUM",
      "rationale": "Platform-specific fallback paths"
    },
    {
      "id": "COVERAGE_GAP_9",
      "name": "FD Modify in internal packages",
      "location": "internal/alternateone/poller_darwin.go:156,180, internal/alternatetwo/poller_darwin.go:112,132",
      "functions": ["UnregisterFD", "ModifyFD"],
      "currentCoverage": "0.0%",
      "estimatedGain": "+2-3%",
      "category": "MEDIUM",
      "rationale": "Platform-specific FD operations"
    },
    {
      "id": "COVERAGE_GAP_10",
      "name": "Shutdown Promise Rejection",
      "location": "internal/alternateone/shutdown.go:127",
      "functions": ["rejectPromises"],
      "currentCoverage": "0.0%",
      "estimatedGain": "+2-3%",
      "category": "MEDIUM",
      "rationale": "Shutdown behavior - promise rejection"
    },
    {
      "id": "COVERAGE_GAP_11",
      "name": "Microtask Direct Submission",
      "location": "internal/alternateone/loop.go:570, internal/alternatethree/loop.go:1099",
      "functions": ["ScheduleMicrotask", "scheduleMicrotask"],
      "currentCoverage": "0.0%",
      "estimatedGain": "+2-3%",
      "category": "MEDIUM",
      "rationale": "Direct microtask scheduling paths"
    },
    {
      "id": "COVERAGE_GAP_12",
      "name": "Metrics Update Paths",
      "location": "metrics.go:160,179,197",
      "functions": ["UpdateIngress", "UpdateInternal", "UpdateMicrotask"],
      "currentCoverage": "0.0%",
      "estimatedGain": "+2-3%",
      "category": "MEDIUM",
      "rationale": "Metrics collection paths"
    },
    {
      "id": "COVERAGE_GAP_13",
      "name": "ClearImmediate",
      "location": "js.go:463",
      "functions": ["ClearImmediate"],
      "currentCoverage": "0.0%",
      "estimatedGain": "+1-2%",
      "category": "HIGH",
      "rationale": "goja-eventloop integration - ClearImmediate API"
    },
    {
      "id": "COVERAGE_GAP_14",
      "name": "ThenWithJS and thenStandalone",
      "location": "promise.go:411, 502",
      "functions": ["ThenWithJS", "thenStandalone"],
      "currentCoverage": "0.0%",
      "estimatedGain": "+3-5%",
      "category": "CRITICAL",
      "rationale": "JS callback integration - already covered in COVERAGE_GAP_2"
    }
  ],
  "lowCoverageFunctions": [
    {
      "file": "loop.go:1210",
      "function": "Wake",
      "coverage": "50.0%",
      "category": "MEDIUM",
      "notes": "Wake loop goroutine - partial coverage"
    },
    {
      "file": "promise.go:584",
      "function": "Finally",
      "coverage": "55.8%",
      "category": "HIGH",
      "notes": "Promise.finally - needs more edge case tests"
    },
    {
      "file": "state.go:37",
      "function": "String",
      "coverage": "42.9%",
      "category": "MEDIUM",
      "notes": "State string representation - missing some states"
    },
    {
      "file": "loop.go:1581",
      "function": "safeExecuteFn",
      "coverage": "66.7%",
      "category": "MEDIUM",
      "notes": "Safe execution helper - partial coverage"
    },
    {
      "file": "internal/alternatethree/registry.go:61",
      "function": "Scavenge",
      "coverage": "13.8%",
      "category": "HIGH",
      "notes": "Weak pointer GC - critical for memory leak prevention"
    },
    {
      "file": "internal/alternatethree/loop.go:582",
      "function": "drainMicrotasks",
      "coverage": "29.4%",
      "category": "MEDIUM",
      "notes": "Microtask drain on shutdown"
    }
  ],
  "testPlan": [
    {
      "area": "Promise Combinators",
      "testFile": "promise_combinators_test.go",
      "testCases": [
        "Promise.all with mixed resolution/rejection",
        "Promise.all with empty array",
        "Promise.all with non-array input",
        "Promise.race with immediate resolution",
        "Promise.race with delayed operations",
        "Promise.race with all rejected",
        "Promise.allSettled with mixed outcomes",
        "Promise.any with one success",
        "Promise.any with all rejected (AggregateError)",
        "Deep nesting of combinators"
      ]
    },
    {
      "area": "JS Promise Integration",
      "testFile": "promise_js_integration_test.go",
      "testCases": [
        ".then() with JavaScript function callbacks",
        ".then() with mixed Go/JS callbacks",
        ".then() chains with JS functions",
        "Error propagation through JS callbacks",
        "thenStandalone edge cases"
      ]
    },
    {
      "area": "Error Path in Poll",
      "testFile": "poll_error_test.go",
      "testCases": [
        "Poll returns error (OS-level failure)",
        "Poll closes unexpectedly",
        "Repeated poll failures",
        "Error recovery after poll failure",
        "Metrics capture poll errors"
      ]
    },
    {
      "area": "State Machine Queries",
      "testFile": "state_machine_test.go",
      "testCases": [
        "IsTerminal returns true for StateTerminated, StateKilled",
        "CanAcceptWork works across all states",
        "TransitionAny with valid and invalid transitions",
        "State machine boundary conditions",
        "Concurrent state queries"
      ]
    },
    {
      "area": "FD Registration",
      "testFile": "fd_registration_test.go",
      "testCases": [
        "Register and immediately unregister FD",
        "Register multiple FDs simultaneously",
        "Modify FD interest (read/write flags)",
        "Unregister during active poll",
        "Concurrent FD operations",
        "Platform-specific Darwin/Linux/Windows behavior"
      ]
    },
    {
      "area": "alternatethree Promise Core",
      "testFile": "promise_alternatethree_test.go",
      "testCases": [
        "Direct Resolve/Reject calls",
        "fanOut with multiple handlers",
        "fanOut with chained promises",
        "State transitions (pending -> fulfilled/rejected)",
        "Result() and ToChannel()",
        "Edge cases: double settlement, settlement after handler attachment"
      ]
    },
    {
      "area": "Registry Scavenge",
      "testFile": "registry_scavenge_test.go",
      "testCases": [
        "Scavenge collects weak pointers",
        "Scavenge doesn't collect strong references",
        "CompactAndRenew evacuates active promises",
        "Memory pressure triggers compaction",
        "Long-running registry doesn't leak",
        "GC interaction with weak pointers"
      ]
    }
  ],
  "summary": {
    "totalEstimatedGain": "+36-42%",
    "totalEstimatedEffort": "13-20 hours",
    "targetAfterTests": "main: 113.5%, internal packages: 90%+",
    "criticalGaps": 7,
    "highPriorityGaps": 6,
    "mediumPriorityGaps": 7,
    "realisticAchievement": "Main package can reach 90%+, internal packages need focused effort"
  }
}
